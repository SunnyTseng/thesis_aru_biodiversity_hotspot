library(seewave)
library(tuneR)
library(tidyverse)
library(here)
# Detection list from 2020, 2021, and 2022 passerine
file_names <- c("2020_passerine_BirdNET.csv",
"2021_passerine_BirdNET.csv",
"2022_passerine_BirdNET.csv")
data <- read_csv(here("data", "JPRF_2020_2021_2022_sound_processed", file))
for (file in file_names){
data <- read_csv(here("data", "JPRF_2020_2021_2022_sound_processed", file))
data_all <- bind_rows(data_all, data)
}
data_all <- tibble()
for (file in file_names){
data <- read_csv(here("data", "JPRF_2020_2021_2022_sound_processed", file))
data_all <- bind_rows(data_all, data)
}
# Clean out the detection with confidence higher than 0.85, got 126 unique species
data_all_0.85 <- data_all %>%
filter(confidence >= 0.85)
data_all$site %>% unique()
data_all$site %>% unique() %>% length()
View(data_all)
cut_interval()
?seq()
seq(from = 0.1, to = 1.0, by = 0.15)
###
### Summarizing data by species (how many detections were received for each of the confidence range,
### how many ARUs out of 66 were getting that specific species?)
###
data_species <- data_all %>%
mutate(confidence_cat = cut_interval(confidence, breaks = seq(from = 0.1, to = 1.0, by = 0.15)))
cut_interval(c(1, 0.5, 0.4), breaks = seq(from = 0.1, to = 1.0, by = 0.15))
cut_interval(c(1, 0.5, 0.4), breaks = seq(from = 0, to = 1.0, by = 0.15))
seq(from = 0.1, to = 1.0, by = 0.15)
seq(from = 0.1, to = 1.0, by = 0.15)
###
### Summarizing data by species (how many detections were received for each of the confidence range,
### how many ARUs out of 66 were getting that specific species?)
###
data_species <- data_all %>%
mutate(confidence_cat = cut_interval(confidence, n = 6, breaks = seq(from = 0.1, to = 1.0, by = 0.15)))
###
### Summarizing data by species (how many detections were received for each of the confidence range,
### how many ARUs out of 66 were getting that specific species?)
###
data_species <- data_all %>%
mutate(confidence_cat = cut_interval(confidence, n = 7, breaks = seq(from = 0.1, to = 1.0, by = 0.15)))
###
### Summarizing data by species (how many detections were received for each of the confidence range,
### how many ARUs out of 66 were getting that specific species?)
###
data_species <- data_all %>%
mutate(confidence_cat = cut_interval(confidence, n = 8, breaks = seq(from = 0.1, to = 1.0, by = 0.15)))
###
### Summarizing data by species (how many detections were received for each of the confidence range,
### how many ARUs out of 66 were getting that specific species?)
###
data_species <- data_all %>%
mutate(confidence_cat = cut(confidence, breaks = seq(from = 0.1, to = 1.0, by = 0.15)))
data_species
View(data_species)
data_species$confidence_cat %>% unique()
data_species$confidence_cat %>% unique() %>% length()
data_species %>% filter(confidence < 0.1)
data_species %>% filter(confidence < 0.15)
###
### Summarizing data by species (how many detections were received for each of the confidence range,
### how many ARUs out of 66 were getting that specific species?)
###
data_species <- data_all %>%
mutate(confidence_cat = cut(confidence, breaks = seq(from = 0.1, to = 1.0, by = 0.15))) %>%
group_nest(common_name)
data_species
data_species$data[[1]]
data_species$data[[1]] %>% filter(confidence_cat == "(0.1,0.25]" %>% nrow())
data_species$data[[1]] %>% filter(confidence_cat == "(0.1,0.25]")
data_species$data[[1]] %>% filter(confidence_cat == "(0.1,0.25]") %>% nrow()
data_species$data[[1]] %>% filter(confidence_cat == "(0.1,0.24]") %>% nrow()
###
### Summarizing data by species (how many detections were received for each of the confidence range,
### how many ARUs out of 66 were getting that specific species?)
###
data_species <- data_all %>%
mutate(confidence_cat = cut(confidence, breaks = seq(from = 0.1, to = 1.0, by = 0.15))) %>%
group_nest(common_name) %>%
mutate(10_25 = map_dbl(.x = data, .f =~ .x %>% filter(confidence_cat == "(0.1,0.25]") %>% nrow()))
###
### Summarizing data by species (how many detections were received for each of the confidence range,
### how many ARUs out of 66 were getting that specific species?)
###
data_species <- data_all %>%
mutate(confidence_cat = cut(confidence, breaks = seq(from = 0.1, to = 1.0, by = 0.15))) %>%
group_nest(common_name) %>%
mutate(c_10_25 = map_dbl(.x = data, .f =~ .x %>% filter(confidence_cat == "(0.1,0.25]") %>% nrow()))
data_species
data_species <- data_all %>%
mutate(confidence_cat = cut(confidence, breaks = seq(from = 0.1, to = 1.0, by = 0.15)))
data_species$confidence_cat %>% unique()
###
### Summarizing data by species (how many detections were received for each of the confidence range,
### how many ARUs out of 66 were getting that specific species?)
###
data_species <- data_all %>%
mutate(confidence_cat = cut(confidence, breaks = seq(from = 0.1, to = 1.0, by = 0.15))) %>%
group_nest(common_name) %>%
mutate(c_10_25 = map_dbl(.x = data, .f =~ .x %>% filter(confidence_cat == "(0.1,0.25]") %>% nrow()),
c_25_40 = map_dbl(.x = data, .f =~ .x %>% filter(confidence_cat == "(0.25,0.4]") %>% nrow()),
c_40_55 = map_dbl(.x = data, .f =~ .x %>% filter(confidence_cat == "(0.4,0.55]") %>% nrow()),
c_55_70 = map_dbl(.x = data, .f =~ .x %>% filter(confidence_cat == "(0.55,0.7]") %>% nrow()),
c_70_85 = map_dbl(.x = data, .f =~ .x %>% filter(confidence_cat == "(0.7,0.85]") %>% nrow()),
c_85_00 = map_dbl(.x = data, .f =~ .x %>% filter(confidence_cat == "(0.85,1]") %>% nrow()))
data_species
data_species <- data_all %>%
mutate(confidence_cat = cut(confidence, breaks = seq(from = 0.1, to = 1.0, by = 0.15))) %>%
group_nest(common_name)
data_species$data[[1]]
data_species$data[[1]] %>% pull(site)
data_species$data[[1]] %>% pull(site) %>% unique()
data_species$data[[1]] %>% pull(site) %>% unique() %>% length()
data_species$data[[1]] %>% n_distinct(site)
data_species$data[[1]] %>% pull(site) %>% n_distinct()
data_species$data[[2]] %>% pull(site) %>% n_distinct()
data_species$data[[3]] %>% pull(site) %>% n_distinct()
###
### Summarizing data by species (how many detections were received for each of the confidence range,
### how many ARUs out of 66 were getting that specific species?)
###
data_species <- data_all %>%
mutate(confidence_cat = cut(confidence, breaks = seq(from = 0.1, to = 1.0, by = 0.15))) %>%
group_nest(common_name) %>%
mutate(c_10_25 = map_dbl(.x = data, .f =~ .x %>% filter(confidence_cat == "(0.1,0.25]") %>% nrow()),
c_25_40 = map_dbl(.x = data, .f =~ .x %>% filter(confidence_cat == "(0.25,0.4]") %>% nrow()),
c_40_55 = map_dbl(.x = data, .f =~ .x %>% filter(confidence_cat == "(0.4,0.55]") %>% nrow()),
c_55_70 = map_dbl(.x = data, .f =~ .x %>% filter(confidence_cat == "(0.55,0.7]") %>% nrow()),
c_70_85 = map_dbl(.x = data, .f =~ .x %>% filter(confidence_cat == "(0.7,0.85]") %>% nrow()),
c_85_100 = map_dbl(.x = data, .f =~ .x %>% filter(confidence_cat == "(0.85,1]") %>% nrow()),
n_ARU = map_dbl(.x = data, .f =~ .x %>% pull(site) %>% n_distinct())) %>%
select(-data)
data_validated <- read_csv(here("docs", "species_list_above_85_validation.csv"))
data_validated_cleaned <- data_validated %>%
drop_na(best)
View(data_species)
data_species_all <- left_join(data_validated_cleaned, data_species)
View(data_species_all)
###
### Summarizing data by species (how many detections were received for each of the confidence range,
### how many ARUs out of 66 were getting that specific species?)
###
data_species <- data_all %>%
mutate(confidence_cat = cut(confidence, breaks = seq(from = 0.1, to = 1.0, by = 0.15))) %>%
group_nest(common_name) %>%
mutate(c_10_25 = map_dbl(.x = data, .f =~ .x %>% filter(confidence_cat == "(0.1,0.25]") %>% nrow()),
c_25_40 = map_dbl(.x = data, .f =~ .x %>% filter(confidence_cat == "(0.25,0.4]") %>% nrow()),
c_40_55 = map_dbl(.x = data, .f =~ .x %>% filter(confidence_cat == "(0.4,0.55]") %>% nrow()),
c_55_70 = map_dbl(.x = data, .f =~ .x %>% filter(confidence_cat == "(0.55,0.7]") %>% nrow()),
c_70_85 = map_dbl(.x = data, .f =~ .x %>% filter(confidence_cat == "(0.7,0.85]") %>% nrow()),
c_85_100 = map_dbl(.x = data, .f =~ .x %>% filter(confidence_cat == "(0.85,1]") %>% nrow()),
n_ARU = map_dbl(.x = data, .f =~ .x %>% pull(site) %>% n_distinct())) %>%
mutate(c_10_25_2020 = map_dbl(.x = data, .f =~ .x %>% filter(year == 2020) %>% filter(confidence_cat == "(0.1,0.25]") %>% nrow()),
c_25_40_2020 = map_dbl(.x = data, .f =~ .x %>% filter(year == 2020) %>% filter(confidence_cat == "(0.25,0.4]") %>% nrow()),
c_40_55_2020 = map_dbl(.x = data, .f =~ .x %>% filter(year == 2020) %>% filter(confidence_cat == "(0.4,0.55]") %>% nrow()),
c_55_70_2020 = map_dbl(.x = data, .f =~ .x %>% filter(year == 2020) %>% filter(confidence_cat == "(0.55,0.7]") %>% nrow()),
c_70_85_2020 = map_dbl(.x = data, .f =~ .x %>% filter(year == 2020) %>% filter(confidence_cat == "(0.7,0.85]") %>% nrow()),
c_85_100_2020 = map_dbl(.x = data, .f =~ .x %>% filter(year == 2020) %>% filter(confidence_cat == "(0.85,1]") %>% nrow()),
n_ARU_2020 = map_dbl(.x = data, .f =~ .x %>% filter(year == 2021) %>% pull(site) %>% n_distinct())) %>%
mutate(c_10_25_2021 = map_dbl(.x = data, .f =~ .x %>% filter(year == 2021) %>% filter(confidence_cat == "(0.1,0.25]") %>% nrow()),
c_25_40_2021 = map_dbl(.x = data, .f =~ .x %>% filter(year == 2021) %>% filter(confidence_cat == "(0.25,0.4]") %>% nrow()),
c_40_55_2021 = map_dbl(.x = data, .f =~ .x %>% filter(year == 2021) %>% filter(confidence_cat == "(0.4,0.55]") %>% nrow()),
c_55_70_2021 = map_dbl(.x = data, .f =~ .x %>% filter(year == 2021) %>% filter(confidence_cat == "(0.55,0.7]") %>% nrow()),
c_70_85_2021 = map_dbl(.x = data, .f =~ .x %>% filter(year == 2021) %>% filter(confidence_cat == "(0.7,0.85]") %>% nrow()),
c_85_100_2021 = map_dbl(.x = data, .f =~ .x %>% filter(year == 2021) %>% filter(confidence_cat == "(0.85,1]") %>% nrow()),
n_ARU_2021 = map_dbl(.x = data, .f =~ .x %>% filter(year == 2021) %>% pull(site) %>% n_distinct())) %>%
mutate(c_10_25_2022 = map_dbl(.x = data, .f =~ .x %>% filter(year == 2022) %>% filter(confidence_cat == "(0.1,0.25]") %>% nrow()),
c_25_40_2022 = map_dbl(.x = data, .f =~ .x %>% filter(year == 2022) %>% filter(confidence_cat == "(0.25,0.4]") %>% nrow()),
c_40_55_2022 = map_dbl(.x = data, .f =~ .x %>% filter(year == 2022) %>% filter(confidence_cat == "(0.4,0.55]") %>% nrow()),
c_55_70_2022 = map_dbl(.x = data, .f =~ .x %>% filter(year == 2022) %>% filter(confidence_cat == "(0.55,0.7]") %>% nrow()),
c_70_85_2022 = map_dbl(.x = data, .f =~ .x %>% filter(year == 2022) %>% filter(confidence_cat == "(0.7,0.85]") %>% nrow()),
c_85_100_2022 = map_dbl(.x = data, .f =~ .x %>% filter(year == 2022) %>% filter(confidence_cat == "(0.85,1]") %>% nrow()),
n_ARU_2022 = map_dbl(.x = data, .f =~ .x %>% filter(year == 2022) %>% pull(site) %>% n_distinct())) %>%
select(-data)
data_species_all <- left_join(data_validated_cleaned, data_species)
data_species_all <- left_join(data_validated, data_species)
write_csv(data_species_all, here("docs", "species_list_above_85_validated_info.csv"))
write_csv(data_species_all, here("docs", "species_list_above_85_validation_info.csv"))

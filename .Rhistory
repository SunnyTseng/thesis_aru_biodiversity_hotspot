###
file_names <- c("2020_passerine_BirdNET.csv",
"2021_passerine_BirdNET.csv",
"2022_passerine_BirdNET.csv")
data_all <- tibble()
for (file in file_names){
data <- read_csv(here("data", "JPRF_2020_2021_2022_sound_processed", file))
data_all <- bind_rows(data_all, data)
}
# clean out the detection with confidence higher than 0.85, got 126 unique species
data_all_0.85 <- data_all %>%
filter(confidence >= 0.85) %>%
mutate(common_name = case_when(
common_name == "Audubon's Warbler" ~ "Yellow-rumped Warbler",
common_name == "Northwestern Crow" ~ "American Crow",
common_name == "Slate-colored Fox Sparrow" ~ "Fox Sparrow",
TRUE ~ common_name)) %>%
mutate(if_else(common_name == "American Yellow Warbler", "Yellow Warbler", common_name))
# make a list of potential recordings based on individual species (126 species for validation)
species_recording <- data_all_0.85 %>%
unite("recording_u", site, recording, start_s, end_s, sep = "_") %>%
arrange(desc(confidence)) %>%
group_nest(common_name) %>%
mutate(recording_1 = map_chr(.x = data, .f =~ .x %>% pull(recording_u) %>% .[1]),
recording_2 = map_chr(.x = data, .f =~ .x %>% pull(recording_u) %>% .[2]),
recording_3 = map_chr(.x = data, .f =~ .x %>% pull(recording_u) %>% .[3]),
recording_4 = map_chr(.x = data, .f =~ .x %>% pull(recording_u) %>% .[4]),
recording_5 = map_chr(.x = data, .f =~ .x %>% pull(recording_u) %>% .[5])) %>%
select(-data)
species_recording
# Filter out the non-validated species and species (108) suggested by Ken that shouldn't be here (103)
data_validated <- read_csv(here("data", "JPRF_species_list",  "species_aru_above_85_validation.csv")) %>%
drop_na(best) %>%
filter(!common_name %in% c("Pygmy Nuthatch",
"Red-naped Sapsucker",
"Williamson's Sapsucker",
"Bay-breasted Warbler",
"Bushtit",
"Northwestern Crow", # there is American Crow on the list
"Slate-colored Fox Sparrow",  # there is Fox Sparrow on the list
"Audubon's Warbler")) %>% # there is yellow-rumped warbler on the list
mutate(if_else(common_name == "American Yellow Warbler", "Yellow Warbler", common_name))
clements_species <- read_csv(here("data", "JPRF_species_list", "Clements-Checklist-v2022-October-2022.csv"))
data_species <- data_all_0.85 %>%
mutate(confidence_cat = cut(confidence, breaks = seq(from = 0.1, to = 1.0, by = 0.15))) %>%
group_nest(common_name) %>%
mutate(c_10_25 = map_dbl(.x = data, .f =~ .x %>% filter(confidence_cat == "(0.1,0.25]") %>% nrow()),
c_25_40 = map_dbl(.x = data, .f =~ .x %>% filter(confidence_cat == "(0.25,0.4]") %>% nrow()),
c_40_55 = map_dbl(.x = data, .f =~ .x %>% filter(confidence_cat == "(0.4,0.55]") %>% nrow()),
c_55_70 = map_dbl(.x = data, .f =~ .x %>% filter(confidence_cat == "(0.55,0.7]") %>% nrow()),
c_70_85 = map_dbl(.x = data, .f =~ .x %>% filter(confidence_cat == "(0.7,0.85]") %>% nrow()),
c_85_100 = map_dbl(.x = data, .f =~ .x %>% filter(confidence_cat == "(0.85,1]") %>% nrow()),
n_ARU = map_dbl(.x = data, .f =~ .x %>% pull(site) %>% n_distinct())) %>%
mutate(c_10_25_2020 = map_dbl(.x = data, .f =~ .x %>% filter(year == 2020) %>% filter(confidence_cat == "(0.1,0.25]") %>% nrow()),
c_25_40_2020 = map_dbl(.x = data, .f =~ .x %>% filter(year == 2020) %>% filter(confidence_cat == "(0.25,0.4]") %>% nrow()),
c_40_55_2020 = map_dbl(.x = data, .f =~ .x %>% filter(year == 2020) %>% filter(confidence_cat == "(0.4,0.55]") %>% nrow()),
c_55_70_2020 = map_dbl(.x = data, .f =~ .x %>% filter(year == 2020) %>% filter(confidence_cat == "(0.55,0.7]") %>% nrow()),
c_70_85_2020 = map_dbl(.x = data, .f =~ .x %>% filter(year == 2020) %>% filter(confidence_cat == "(0.7,0.85]") %>% nrow()),
c_85_100_2020 = map_dbl(.x = data, .f =~ .x %>% filter(year == 2020) %>% filter(confidence_cat == "(0.85,1]") %>% nrow()),
n_ARU_2020 = map_dbl(.x = data, .f =~ .x %>% filter(year == 2021) %>% pull(site) %>% n_distinct())) %>%
mutate(c_10_25_2021 = map_dbl(.x = data, .f =~ .x %>% filter(year == 2021) %>% filter(confidence_cat == "(0.1,0.25]") %>% nrow()),
c_25_40_2021 = map_dbl(.x = data, .f =~ .x %>% filter(year == 2021) %>% filter(confidence_cat == "(0.25,0.4]") %>% nrow()),
c_40_55_2021 = map_dbl(.x = data, .f =~ .x %>% filter(year == 2021) %>% filter(confidence_cat == "(0.4,0.55]") %>% nrow()),
c_55_70_2021 = map_dbl(.x = data, .f =~ .x %>% filter(year == 2021) %>% filter(confidence_cat == "(0.55,0.7]") %>% nrow()),
c_70_85_2021 = map_dbl(.x = data, .f =~ .x %>% filter(year == 2021) %>% filter(confidence_cat == "(0.7,0.85]") %>% nrow()),
c_85_100_2021 = map_dbl(.x = data, .f =~ .x %>% filter(year == 2021) %>% filter(confidence_cat == "(0.85,1]") %>% nrow()),
n_ARU_2021 = map_dbl(.x = data, .f =~ .x %>% filter(year == 2021) %>% pull(site) %>% n_distinct())) %>%
mutate(c_10_25_2022 = map_dbl(.x = data, .f =~ .x %>% filter(year == 2022) %>% filter(confidence_cat == "(0.1,0.25]") %>% nrow()),
c_25_40_2022 = map_dbl(.x = data, .f =~ .x %>% filter(year == 2022) %>% filter(confidence_cat == "(0.25,0.4]") %>% nrow()),
c_40_55_2022 = map_dbl(.x = data, .f =~ .x %>% filter(year == 2022) %>% filter(confidence_cat == "(0.4,0.55]") %>% nrow()),
c_55_70_2022 = map_dbl(.x = data, .f =~ .x %>% filter(year == 2022) %>% filter(confidence_cat == "(0.55,0.7]") %>% nrow()),
c_70_85_2022 = map_dbl(.x = data, .f =~ .x %>% filter(year == 2022) %>% filter(confidence_cat == "(0.7,0.85]") %>% nrow()),
c_85_100_2022 = map_dbl(.x = data, .f =~ .x %>% filter(year == 2022) %>% filter(confidence_cat == "(0.85,1]") %>% nrow()),
n_ARU_2022 = map_dbl(.x = data, .f =~ .x %>% filter(year == 2022) %>% pull(site) %>% n_distinct())) %>%
select(-data)
data_validated_1 <- left_join(data_validated, data_species) %>%
left_join(clements_species, by = c("common_name" = "English name")) %>%
select(common_name, "scientific name", "order", "family", 14:41)
data_validated_1
data_validated_1[9]
data_validated_1[9, ]
# Filter out the non-validated species and species (108) suggested by Ken that shouldn't be here (103)
data_validated <- read_csv(here("data", "JPRF_species_list",  "species_aru_above_85_validation.csv")) %>%
drop_na(best) %>%
filter(!common_name %in% c("Pygmy Nuthatch",
"Red-naped Sapsucker",
"Williamson's Sapsucker",
"Bay-breasted Warbler",
"Bushtit",
"Northwestern Crow", # there is American Crow on the list
"Slate-colored Fox Sparrow",  # there is Fox Sparrow on the list
"Audubon's Warbler")) %>% # there is yellow-rumped warbler on the list
mutate(common_name = if_else(common_name == "American Yellow Warbler", "Yellow Warbler", common_name))
clements_species <- read_csv(here("data", "JPRF_species_list", "Clements-Checklist-v2022-October-2022.csv"))
data_species <- data_all_0.85 %>%
mutate(confidence_cat = cut(confidence, breaks = seq(from = 0.1, to = 1.0, by = 0.15))) %>%
group_nest(common_name) %>%
mutate(c_10_25 = map_dbl(.x = data, .f =~ .x %>% filter(confidence_cat == "(0.1,0.25]") %>% nrow()),
c_25_40 = map_dbl(.x = data, .f =~ .x %>% filter(confidence_cat == "(0.25,0.4]") %>% nrow()),
c_40_55 = map_dbl(.x = data, .f =~ .x %>% filter(confidence_cat == "(0.4,0.55]") %>% nrow()),
c_55_70 = map_dbl(.x = data, .f =~ .x %>% filter(confidence_cat == "(0.55,0.7]") %>% nrow()),
c_70_85 = map_dbl(.x = data, .f =~ .x %>% filter(confidence_cat == "(0.7,0.85]") %>% nrow()),
c_85_100 = map_dbl(.x = data, .f =~ .x %>% filter(confidence_cat == "(0.85,1]") %>% nrow()),
n_ARU = map_dbl(.x = data, .f =~ .x %>% pull(site) %>% n_distinct())) %>%
mutate(c_10_25_2020 = map_dbl(.x = data, .f =~ .x %>% filter(year == 2020) %>% filter(confidence_cat == "(0.1,0.25]") %>% nrow()),
c_25_40_2020 = map_dbl(.x = data, .f =~ .x %>% filter(year == 2020) %>% filter(confidence_cat == "(0.25,0.4]") %>% nrow()),
c_40_55_2020 = map_dbl(.x = data, .f =~ .x %>% filter(year == 2020) %>% filter(confidence_cat == "(0.4,0.55]") %>% nrow()),
c_55_70_2020 = map_dbl(.x = data, .f =~ .x %>% filter(year == 2020) %>% filter(confidence_cat == "(0.55,0.7]") %>% nrow()),
c_70_85_2020 = map_dbl(.x = data, .f =~ .x %>% filter(year == 2020) %>% filter(confidence_cat == "(0.7,0.85]") %>% nrow()),
c_85_100_2020 = map_dbl(.x = data, .f =~ .x %>% filter(year == 2020) %>% filter(confidence_cat == "(0.85,1]") %>% nrow()),
n_ARU_2020 = map_dbl(.x = data, .f =~ .x %>% filter(year == 2021) %>% pull(site) %>% n_distinct())) %>%
mutate(c_10_25_2021 = map_dbl(.x = data, .f =~ .x %>% filter(year == 2021) %>% filter(confidence_cat == "(0.1,0.25]") %>% nrow()),
c_25_40_2021 = map_dbl(.x = data, .f =~ .x %>% filter(year == 2021) %>% filter(confidence_cat == "(0.25,0.4]") %>% nrow()),
c_40_55_2021 = map_dbl(.x = data, .f =~ .x %>% filter(year == 2021) %>% filter(confidence_cat == "(0.4,0.55]") %>% nrow()),
c_55_70_2021 = map_dbl(.x = data, .f =~ .x %>% filter(year == 2021) %>% filter(confidence_cat == "(0.55,0.7]") %>% nrow()),
c_70_85_2021 = map_dbl(.x = data, .f =~ .x %>% filter(year == 2021) %>% filter(confidence_cat == "(0.7,0.85]") %>% nrow()),
c_85_100_2021 = map_dbl(.x = data, .f =~ .x %>% filter(year == 2021) %>% filter(confidence_cat == "(0.85,1]") %>% nrow()),
n_ARU_2021 = map_dbl(.x = data, .f =~ .x %>% filter(year == 2021) %>% pull(site) %>% n_distinct())) %>%
mutate(c_10_25_2022 = map_dbl(.x = data, .f =~ .x %>% filter(year == 2022) %>% filter(confidence_cat == "(0.1,0.25]") %>% nrow()),
c_25_40_2022 = map_dbl(.x = data, .f =~ .x %>% filter(year == 2022) %>% filter(confidence_cat == "(0.25,0.4]") %>% nrow()),
c_40_55_2022 = map_dbl(.x = data, .f =~ .x %>% filter(year == 2022) %>% filter(confidence_cat == "(0.4,0.55]") %>% nrow()),
c_55_70_2022 = map_dbl(.x = data, .f =~ .x %>% filter(year == 2022) %>% filter(confidence_cat == "(0.55,0.7]") %>% nrow()),
c_70_85_2022 = map_dbl(.x = data, .f =~ .x %>% filter(year == 2022) %>% filter(confidence_cat == "(0.7,0.85]") %>% nrow()),
c_85_100_2022 = map_dbl(.x = data, .f =~ .x %>% filter(year == 2022) %>% filter(confidence_cat == "(0.85,1]") %>% nrow()),
n_ARU_2022 = map_dbl(.x = data, .f =~ .x %>% filter(year == 2022) %>% pull(site) %>% n_distinct())) %>%
select(-data)
data_validated_1 <- left_join(data_validated, data_species) %>%
left_join(clements_species, by = c("common_name" = "English name")) %>%
select(common_name, "scientific name", "order", "family", 14:41)
data_validated_1
data_all_0.85_species <- data_all_0.85 %>%
filter(common_name %in% data_validated_1$common_name) %>%
select(year, month, day, site, recording, start_s, end_s, common_name)
data_all_0.85_species
data_all_0.85_species$common_name %>% unique()
data_all_0.85$common_name %>% unique()
data_validated_1$common_name %>% unique()
# clean out the detection with confidence higher than 0.85, got 126 unique species
data_all_0.85 <- data_all %>%
filter(confidence >= 0.85) %>%
mutate(common_name = case_when(
common_name == "Audubon's Warbler" ~ "Yellow-rumped Warbler",
common_name == "Northwestern Crow" ~ "American Crow",
common_name == "Slate-colored Fox Sparrow" ~ "Fox Sparrow",
TRUE ~ common_name)) %>%
mutate(common_name = if_else(common_name == "American Yellow Warbler", "Yellow Warbler", common_name))
data_all_0.85_species <- data_all_0.85 %>%
filter(common_name %in% data_validated_1$common_name) %>%
select(year, month, day, site, recording, start_s, end_s, common_name)
data_all_0.85_species$common_name %>% unique()
data_all_0.85_species
write_csv(data_all_0.85_species, here("data", "detection_aru_target_sp_85.csv"))
rm(list = ls())
###
### Library
###
library(seewave)
library(tuneR)
library(tidyverse)
library(here)
###
### Detection list from 2020, 2021, and 2022 passerine
###
file_names <- c("2020_passerine_BirdNET.csv",
"2021_passerine_BirdNET.csv",
"2022_passerine_BirdNET.csv")
data_all <- tibble()
for (file in file_names){
data <- read_csv(here("data", "JPRF_2020_2021_2022_sound_processed", file))
data_all <- bind_rows(data_all, data)
}
# clean out the detection with confidence higher than 0.85, got 126 unique species
data_all_0.85 <- data_all %>%
filter(confidence >= 0.85) %>%
mutate(common_name = case_when(
common_name == "Audubon's Warbler" ~ "Yellow-rumped Warbler",
common_name == "Northwestern Crow" ~ "American Crow",
common_name == "Slate-colored Fox Sparrow" ~ "Fox Sparrow",
TRUE ~ common_name)) %>%
mutate(common_name = if_else(common_name == "American Yellow Warbler", "Yellow Warbler", common_name))
# make a list of potential recordings based on individual species (126 species for validation)
species_recording <- data_all_0.85 %>%
unite("recording_u", site, recording, start_s, end_s, sep = "_") %>%
arrange(desc(confidence)) %>%
group_nest(common_name) %>%
mutate(recording_1 = map_chr(.x = data, .f =~ .x %>% pull(recording_u) %>% .[1]),
recording_2 = map_chr(.x = data, .f =~ .x %>% pull(recording_u) %>% .[2]),
recording_3 = map_chr(.x = data, .f =~ .x %>% pull(recording_u) %>% .[3]),
recording_4 = map_chr(.x = data, .f =~ .x %>% pull(recording_u) %>% .[4]),
recording_5 = map_chr(.x = data, .f =~ .x %>% pull(recording_u) %>% .[5])) %>%
select(-data)
###
### listen to the target recordings
###
species <- 126 # range from 1 to 126 for 126 species
# Filter out the non-validated species and species (108) suggested by Ken that shouldn't be here (103)
data_validated <- read_csv(here("data", "JPRF_species_list",  "species_aru_85_validation.csv")) %>%
drop_na(best) %>%
filter(!common_name %in% c("Pygmy Nuthatch",
"Red-naped Sapsucker",
"Williamson's Sapsucker",
"Bay-breasted Warbler",
"Bushtit",
"Northwestern Crow", # there is American Crow on the list
"Slate-colored Fox Sparrow",  # there is Fox Sparrow on the list
"Audubon's Warbler")) %>% # there is yellow-rumped warbler on the list
mutate(common_name = if_else(common_name == "American Yellow Warbler", "Yellow Warbler", common_name)) # make the name fit the Cornell list
clements_species <- read_csv(here("data", "JPRF_species_list", "Clements-Checklist-v2022-October-2022.csv"))
data_species <- data_all_0.85 %>%
mutate(confidence_cat = cut(confidence, breaks = seq(from = 0.1, to = 1.0, by = 0.15))) %>%
group_nest(common_name) %>%
mutate(c_10_25 = map_dbl(.x = data, .f =~ .x %>% filter(confidence_cat == "(0.1,0.25]") %>% nrow()),
c_25_40 = map_dbl(.x = data, .f =~ .x %>% filter(confidence_cat == "(0.25,0.4]") %>% nrow()),
c_40_55 = map_dbl(.x = data, .f =~ .x %>% filter(confidence_cat == "(0.4,0.55]") %>% nrow()),
c_55_70 = map_dbl(.x = data, .f =~ .x %>% filter(confidence_cat == "(0.55,0.7]") %>% nrow()),
c_70_85 = map_dbl(.x = data, .f =~ .x %>% filter(confidence_cat == "(0.7,0.85]") %>% nrow()),
c_85_100 = map_dbl(.x = data, .f =~ .x %>% filter(confidence_cat == "(0.85,1]") %>% nrow()),
n_ARU = map_dbl(.x = data, .f =~ .x %>% pull(site) %>% n_distinct())) %>%
mutate(c_10_25_2020 = map_dbl(.x = data, .f =~ .x %>% filter(year == 2020) %>% filter(confidence_cat == "(0.1,0.25]") %>% nrow()),
c_25_40_2020 = map_dbl(.x = data, .f =~ .x %>% filter(year == 2020) %>% filter(confidence_cat == "(0.25,0.4]") %>% nrow()),
c_40_55_2020 = map_dbl(.x = data, .f =~ .x %>% filter(year == 2020) %>% filter(confidence_cat == "(0.4,0.55]") %>% nrow()),
c_55_70_2020 = map_dbl(.x = data, .f =~ .x %>% filter(year == 2020) %>% filter(confidence_cat == "(0.55,0.7]") %>% nrow()),
c_70_85_2020 = map_dbl(.x = data, .f =~ .x %>% filter(year == 2020) %>% filter(confidence_cat == "(0.7,0.85]") %>% nrow()),
c_85_100_2020 = map_dbl(.x = data, .f =~ .x %>% filter(year == 2020) %>% filter(confidence_cat == "(0.85,1]") %>% nrow()),
n_ARU_2020 = map_dbl(.x = data, .f =~ .x %>% filter(year == 2021) %>% pull(site) %>% n_distinct())) %>%
mutate(c_10_25_2021 = map_dbl(.x = data, .f =~ .x %>% filter(year == 2021) %>% filter(confidence_cat == "(0.1,0.25]") %>% nrow()),
c_25_40_2021 = map_dbl(.x = data, .f =~ .x %>% filter(year == 2021) %>% filter(confidence_cat == "(0.25,0.4]") %>% nrow()),
c_40_55_2021 = map_dbl(.x = data, .f =~ .x %>% filter(year == 2021) %>% filter(confidence_cat == "(0.4,0.55]") %>% nrow()),
c_55_70_2021 = map_dbl(.x = data, .f =~ .x %>% filter(year == 2021) %>% filter(confidence_cat == "(0.55,0.7]") %>% nrow()),
c_70_85_2021 = map_dbl(.x = data, .f =~ .x %>% filter(year == 2021) %>% filter(confidence_cat == "(0.7,0.85]") %>% nrow()),
c_85_100_2021 = map_dbl(.x = data, .f =~ .x %>% filter(year == 2021) %>% filter(confidence_cat == "(0.85,1]") %>% nrow()),
n_ARU_2021 = map_dbl(.x = data, .f =~ .x %>% filter(year == 2021) %>% pull(site) %>% n_distinct())) %>%
mutate(c_10_25_2022 = map_dbl(.x = data, .f =~ .x %>% filter(year == 2022) %>% filter(confidence_cat == "(0.1,0.25]") %>% nrow()),
c_25_40_2022 = map_dbl(.x = data, .f =~ .x %>% filter(year == 2022) %>% filter(confidence_cat == "(0.25,0.4]") %>% nrow()),
c_40_55_2022 = map_dbl(.x = data, .f =~ .x %>% filter(year == 2022) %>% filter(confidence_cat == "(0.4,0.55]") %>% nrow()),
c_55_70_2022 = map_dbl(.x = data, .f =~ .x %>% filter(year == 2022) %>% filter(confidence_cat == "(0.55,0.7]") %>% nrow()),
c_70_85_2022 = map_dbl(.x = data, .f =~ .x %>% filter(year == 2022) %>% filter(confidence_cat == "(0.7,0.85]") %>% nrow()),
c_85_100_2022 = map_dbl(.x = data, .f =~ .x %>% filter(year == 2022) %>% filter(confidence_cat == "(0.85,1]") %>% nrow()),
n_ARU_2022 = map_dbl(.x = data, .f =~ .x %>% filter(year == 2022) %>% pull(site) %>% n_distinct())) %>%
select(-data)
data_all_0.85_species <- data_all_0.85 %>%
filter(common_name %in% data_validated_1$common_name) %>%
select(year, month, day, site, recording, start_s, end_s, common_name)
data_validated_1 <- left_join(data_validated, data_species) %>%
left_join(clements_species, by = c("common_name" = "English name")) %>%
select(common_name, "scientific name", "order", "family", 14:41)
data_all_0.85_species <- data_all_0.85 %>%
filter(common_name %in% data_validated_1$common_name) %>%
select(year, month, day, site, recording, start_s, end_s, common_name)
data_all_0.85_species
data_all_0.85_species$common_name %>% unique()
write_csv(data_all_0.85_species, here("data", "detection_aru_target_sp_85.csv"))
rm(list = ls())
library(tidyverse)
library(here)
### Import data
data <- read_csv(here("data", "detection_aru_target_sp_85.csv"))
data
data
View(data)
data$common_name
###
### Library
###
library(seewave)
library(tuneR)
library(tidyverse)
library(here)
###
### Detection list from 2020, 2021, and 2022 passerine
###
file_names <- c("2020_passerine_BirdNET.csv",
"2021_passerine_BirdNET.csv",
"2022_passerine_BirdNET.csv")
data_all <- tibble()
for (file in file_names){
data <- read_csv(here("data", "JPRF_2020_2021_2022_sound_processed", file))
data_all <- bind_rows(data_all, data)
}
# clean out the detection with confidence higher than 0.85, got 126 unique species
data_all_0.85 <- data_all %>%
filter(confidence >= 0.85) %>%
mutate(common_name = case_when(
common_name == "Audubon's Warbler" ~ "Yellow-rumped Warbler",
common_name == "Northwestern Crow" ~ "American Crow",
common_name == "Slate-colored Fox Sparrow" ~ "Fox Sparrow",
TRUE ~ common_name)) %>%
mutate(common_name = if_else(common_name == "American Yellow Warbler", "Yellow Warbler", common_name))
# make a list of potential recordings based on individual species (126 species for validation)
species_recording <- data_all_0.85 %>%
unite("recording_u", site, recording, start_s, end_s, sep = "_") %>%
arrange(desc(confidence)) %>%
group_nest(common_name) %>%
mutate(recording_1 = map_chr(.x = data, .f =~ .x %>% pull(recording_u) %>% .[1]),
recording_2 = map_chr(.x = data, .f =~ .x %>% pull(recording_u) %>% .[2]),
recording_3 = map_chr(.x = data, .f =~ .x %>% pull(recording_u) %>% .[3]),
recording_4 = map_chr(.x = data, .f =~ .x %>% pull(recording_u) %>% .[4]),
recording_5 = map_chr(.x = data, .f =~ .x %>% pull(recording_u) %>% .[5])) %>%
select(-data)
###
### listen to the target recordings
###
species <- 126 # range from 1 to 126 for 126 species
# Filter out the non-validated species and species (108) suggested by Ken that shouldn't be here (103)
data_validated <- read_csv(here("data", "JPRF_species_list",  "species_aru_85_validation.csv")) %>%
drop_na(best) %>%
filter(!common_name %in% c("Pygmy Nuthatch",
"Red-naped Sapsucker",
"Williamson's Sapsucker",
"Bay-breasted Warbler",
"Bushtit",
"Northwestern Crow", # there is American Crow on the list
"Slate-colored Fox Sparrow",  # there is Fox Sparrow on the list
"Audubon's Warbler")) %>% # there is yellow-rumped warbler on the list
mutate(common_name = if_else(common_name == "American Yellow Warbler", "Yellow Warbler", common_name)) # make the name fit the Cornell list
clements_species <- read_csv(here("data", "JPRF_species_list", "Clements-Checklist-v2022-October-2022.csv"))
data_species <- data_all_0.85 %>%
mutate(confidence_cat = cut(confidence, breaks = seq(from = 0.1, to = 1.0, by = 0.15))) %>%
group_nest(common_name) %>%
mutate(c_10_25 = map_dbl(.x = data, .f =~ .x %>% filter(confidence_cat == "(0.1,0.25]") %>% nrow()),
c_25_40 = map_dbl(.x = data, .f =~ .x %>% filter(confidence_cat == "(0.25,0.4]") %>% nrow()),
c_40_55 = map_dbl(.x = data, .f =~ .x %>% filter(confidence_cat == "(0.4,0.55]") %>% nrow()),
c_55_70 = map_dbl(.x = data, .f =~ .x %>% filter(confidence_cat == "(0.55,0.7]") %>% nrow()),
c_70_85 = map_dbl(.x = data, .f =~ .x %>% filter(confidence_cat == "(0.7,0.85]") %>% nrow()),
c_85_100 = map_dbl(.x = data, .f =~ .x %>% filter(confidence_cat == "(0.85,1]") %>% nrow()),
n_ARU = map_dbl(.x = data, .f =~ .x %>% pull(site) %>% n_distinct())) %>%
mutate(c_10_25_2020 = map_dbl(.x = data, .f =~ .x %>% filter(year == 2020) %>% filter(confidence_cat == "(0.1,0.25]") %>% nrow()),
c_25_40_2020 = map_dbl(.x = data, .f =~ .x %>% filter(year == 2020) %>% filter(confidence_cat == "(0.25,0.4]") %>% nrow()),
c_40_55_2020 = map_dbl(.x = data, .f =~ .x %>% filter(year == 2020) %>% filter(confidence_cat == "(0.4,0.55]") %>% nrow()),
c_55_70_2020 = map_dbl(.x = data, .f =~ .x %>% filter(year == 2020) %>% filter(confidence_cat == "(0.55,0.7]") %>% nrow()),
c_70_85_2020 = map_dbl(.x = data, .f =~ .x %>% filter(year == 2020) %>% filter(confidence_cat == "(0.7,0.85]") %>% nrow()),
c_85_100_2020 = map_dbl(.x = data, .f =~ .x %>% filter(year == 2020) %>% filter(confidence_cat == "(0.85,1]") %>% nrow()),
n_ARU_2020 = map_dbl(.x = data, .f =~ .x %>% filter(year == 2021) %>% pull(site) %>% n_distinct())) %>%
mutate(c_10_25_2021 = map_dbl(.x = data, .f =~ .x %>% filter(year == 2021) %>% filter(confidence_cat == "(0.1,0.25]") %>% nrow()),
c_25_40_2021 = map_dbl(.x = data, .f =~ .x %>% filter(year == 2021) %>% filter(confidence_cat == "(0.25,0.4]") %>% nrow()),
c_40_55_2021 = map_dbl(.x = data, .f =~ .x %>% filter(year == 2021) %>% filter(confidence_cat == "(0.4,0.55]") %>% nrow()),
c_55_70_2021 = map_dbl(.x = data, .f =~ .x %>% filter(year == 2021) %>% filter(confidence_cat == "(0.55,0.7]") %>% nrow()),
c_70_85_2021 = map_dbl(.x = data, .f =~ .x %>% filter(year == 2021) %>% filter(confidence_cat == "(0.7,0.85]") %>% nrow()),
c_85_100_2021 = map_dbl(.x = data, .f =~ .x %>% filter(year == 2021) %>% filter(confidence_cat == "(0.85,1]") %>% nrow()),
n_ARU_2021 = map_dbl(.x = data, .f =~ .x %>% filter(year == 2021) %>% pull(site) %>% n_distinct())) %>%
mutate(c_10_25_2022 = map_dbl(.x = data, .f =~ .x %>% filter(year == 2022) %>% filter(confidence_cat == "(0.1,0.25]") %>% nrow()),
c_25_40_2022 = map_dbl(.x = data, .f =~ .x %>% filter(year == 2022) %>% filter(confidence_cat == "(0.25,0.4]") %>% nrow()),
c_40_55_2022 = map_dbl(.x = data, .f =~ .x %>% filter(year == 2022) %>% filter(confidence_cat == "(0.4,0.55]") %>% nrow()),
c_55_70_2022 = map_dbl(.x = data, .f =~ .x %>% filter(year == 2022) %>% filter(confidence_cat == "(0.55,0.7]") %>% nrow()),
c_70_85_2022 = map_dbl(.x = data, .f =~ .x %>% filter(year == 2022) %>% filter(confidence_cat == "(0.7,0.85]") %>% nrow()),
c_85_100_2022 = map_dbl(.x = data, .f =~ .x %>% filter(year == 2022) %>% filter(confidence_cat == "(0.85,1]") %>% nrow()),
n_ARU_2022 = map_dbl(.x = data, .f =~ .x %>% filter(year == 2022) %>% pull(site) %>% n_distinct())) %>%
select(-data)
data_validated_1 <- left_join(data_validated, data_species) %>%
left_join(clements_species, by = c("common_name" = "English name")) %>%
select(common_name, "scientific name", "order", "family", 14:41)
data_validated_1
data_validated_1 %>% colnames()
data_all_0.85_species <- data_all_0.85 %>%
filter(common_name %in% data_validated_1$common_name) %>%
left_join(clements_species, by = c("common_name" = "English name")) %>%
select(year, month, day, site, recording, start_s, end_s, common_name, order, family, `scientific name`)
data_all_0.85_species
data_all_0.85_species <- data_all_0.85 %>%
filter(common_name %in% data_validated_1$common_name) %>%
left_join(clements_species, by = c("common_name" = "English name")) %>%
select(year, month, day, site, recording, start_s, end_s, common_name, order, family, "scientific name")
data_all_0.85_species$`scientific name` %>% unique()
write_csv(data_all_0.85_species, here("data", "detection_aru_target_sp_85.csv"))
### Library
library(tidyverse)
library(here)
### Import data
data <- read_csv(here("data", "detection_aru_target_sp_85.csv"))
data
rm(list = ls())
inc_data <- data %>%
group_nest(common_name)
### Library
library(tidyverse)
library(here)
### Import data
data <- read_csv(here("data", "detection_aru_target_sp_85.csv"))
inc_data <- data %>%
group_nest(common_name)
inc_data
n_sites <- data$site %>% n_distinct()
n_site
n_sites
data$site
data$site %>% unique()
###
### Library
###
library(seewave)
library(tuneR)
library(tidyverse)
library(here)
###
### Detection list from 2020, 2021, and 2022 passerine
###
file_names <- c("2020_passerine_BirdNET.csv",
"2021_passerine_BirdNET.csv",
"2022_passerine_BirdNET.csv")
data_all <- tibble()
for (file in file_names){
data <- read_csv(here("data", "JPRF_2020_2021_2022_sound_processed", file))
data_all <- bind_rows(data_all, data)
}
data_all$site %>% unique()
data_all$site %>% n_distinct()
n_sites
### Import data
data <- read_csv(here("data", "detection_aru_target_sp_85.csv"))
n_sites <- data$site
data %>% unique()
n_sites
n_sites %>% unique()
rm(list = ls())
###
### Library
###
library(seewave)
library(tuneR)
library(tidyverse)
library(here)
###
### Detection list from 2020, 2021, and 2022 passerine
###
file_names <- c("2020_passerine_BirdNET.csv",
"2021_passerine_BirdNET.csv",
"2022_passerine_BirdNET.csv")
data_all <- tibble()
for (file in file_names){
data <- read_csv(here("data", "JPRF_2020_2021_2022_sound_processed", file))
data_all <- bind_rows(data_all, data)
}
data_all
data_all %>% filter(year == 2020) %>% pull(site) %>% unique()
data_all %>% filter(year == 2021) %>% pull(site) %>% unique()
data_all %>% filter(year == 2022) %>% pull(site) %>% unique()
### Library
library(tidyverse)
library(here)
### Library
library(tidyverse)
library(here)
here()
effort_list <- c("2020_passerine_effort.csv",
"2021_passerine_effort.csv",
"2022_passerine_effort.csv")
effort_all <- tibble()
for (file in effort_list) {
effort_temp <- read_csv(here("data", "JPRF_aru_effort", file))
effort_all <- rbind(effort_all, effort_temp)
}
effort_all
effort_all_1 <- effort_all %>%
unite(col = date, year, month, day, remove = FALSE) %>%
mutate(date = ymd(date))
library(lubridate)
effort_all_1 <- effort_all %>%
unite(col = date, year, month, day, remove = FALSE) %>%
mutate(date = ymd(date))
effort_all_1
View(effort_all_1)
effort_all_1 <- effort_all %>%
unite(col = date, year, month, day, remove = FALSE) %>%
mutate(date = ymd(date)) %>%
filter(size != 5760360)
effort_all_1
View(effort_all_1)
print(effort_all_1, n = 200)
effort_all_1 <- effort_all %>%
unite(col = date, year, month, day, remove = FALSE) %>%
mutate(date = ymd(date)) %>%
filter(size !%in% c(5760360, 5760488))
effort_all_1 <- effort_all %>%
unite(col = date, year, month, day, remove = FALSE) %>%
mutate(date = ymd(date)) %>%
filter(!size %in% c(5760360, 5760488))
print(effort_all_1, n = 200)
print(effort_all_1, n = 500)
print(effort_all_1, n = 1000)
effort_all_1$size %>% range()
effort_all_1$size %>% plot
effort_all_1 <- effort_all %>%
unite(col = date, year, month, day, remove = FALSE) %>%
mutate(date = ymd(date)) %>%
filter(size >= 5760000 & size <= 5760500)
effort_all_1
effort_all_1 <- effort_all %>%
unite(col = date, year, month, day, remove = FALSE) %>%
mutate(date = ymd(date)) %>%
filter(size <= 5760000 | size >= 5760500)
effort_all_1
effort_all_1 <- effort_all %>%
unite(col = date, year, month, day, remove = FALSE) %>%
mutate(date = ymd(date)) %>%
filter(size >= 5760000 | size <= 5760500)
effort_all_1
280945/60
280945/60/24
280945/60/3
280945/60/3/66
effort_all_1 <- effort_all %>%
unite(col = date, year, month, day, remove = FALSE) %>%
mutate(date = ymd(date)) %>%
filter(size >= 5760000 | size <= 5760500) %>%
group_nest(date)
effort_all_1
effort_all_1 <- effort_all %>%
unite(col = date, year, month, day, remove = FALSE) %>%
mutate(date = ymd(date)) %>%
filter(size >= 5760000 | size <= 5760500) %>%
group_nest(date, site)
effort_all_1
